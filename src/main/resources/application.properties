# ============================================
# APPLICATION INFO
# ============================================
spring.application.name=dashboard-service
server.port=8082
server.servlet.context-path=/api
logging.config=classpath:log4j2.properties

# ============================================
# DATABASE (PostgreSQL)
# ============================================
spring.datasource.driver-class-name=org.postgresql.Driver
spring.sql.init.platform=postgresql
spring.datasource.url=jdbc:postgresql://10.153.36.161:5432/ctdlocal
spring.datasource.username=postgres
spring.datasource.password=post123

#spring.datasource.url=jdbc:postgresql://10.153.45.169:5432/gst_db
#spring.datasource.username=gst_admin
#spring.datasource.password=stage123

# HikariCP
spring.datasource.hikari.minimum-idle=10
spring.datasource.hikari.maximum-pool-size=25
spring.datasource.hikari.connection-timeout=20000
spring.datasource.hikari.idle-timeout=60000
spring.datasource.hikari.max-lifetime=1800000
spring.datasource.hikari.keepalive-time=300000

# Statement cache
spring.datasource.hikari.data-source-properties.cachePrepStmts=true
spring.datasource.hikari.data-source-properties.prepStmtCacheSize=250
spring.datasource.hikari.data-source-properties.prepStmtCacheSqlLimit=2048
spring.datasource.hikari.data-source-properties.rewriteBatchedStatements=true
spring.datasource.hikari.data-source-properties.stringtype=unspecified
spring.datasource.hikari.data-source-properties.logUnclosedConnections=true

spring.main.allow-bean-definition-overriding=false

# ============================================
# SECURITY (JWT Resource Server)
# ============================================
spring.security.oauth2.resourceserver.jwt.jwk-set-uri=http://auth-service:8081/api/auth/.well-known/jwks.json
spring.security.oauth2.resourceserver.jwt.issuer-uri=http://auth-service:8081

#spring.security.oauth2.resourceserver.jwt.jwk-set-uri=http://10.153.45.169:8081/api/auth/.well-known/jwks.json
#spring.security.oauth2.resourceserver.jwt.issuer-uri=http://10.153.45.169:8081

# ============================================
# CUSTOM APP SETTINGS
# ============================================
app.cors.allowed-origins=*
app.cors.allowed-methods=GET,POST,PUT,DELETE,OPTIONS

app.token.audience=dashboard-service
app.token.cookie-name=access_token

# ============================================
# ACTUATOR / MANAGEMENT
# ============================================
management.endpoints.web.exposure.include=health,info,logfile,metrics,prometheus,circuitbreakers
management.endpoint.health.show-details=always

# ============================================
# REDIS (FIXED & VALID SPRING BOOT CONFIG)
# ============================================
spring.redis.host=10.153.43.8
spring.redis.port=6379
spring.redis.password=
spring.redis.database=0
spring.redis.timeout=6000ms

# Lettuce pool settings
spring.redis.lettuce.pool.max-active=50
spring.redis.lettuce.pool.max-idle=20
spring.redis.lettuce.pool.min-idle=5
spring.redis.lettuce.pool.time-between-eviction-runs=10s

spring.jackson.deserialization.accept-empty-array-as-null-object=true
spring.jackson.deserialization.accept-single-value-as-array=true

# File upload physical location
#upload.path=F:/uploads/profile-pics/

upload.path=/uploads/profile-pics/

# URL prefix to access uploaded files from frontend
#file.base-url=http://localhost:8082/api/uploads/profile-pics/

file.base-url=http://10.153.43.8:8082/api/uploads/profile-pics/

#upload.path=F:/uploads/profile-pics/
#file.base-url=http://localhost:8082/api/uploads/profile-pics/
